<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>다각형에 이벤트 등록하기2</title>
    <style>
        .area {
            position: absolute;
            background: #fff;
            border: 1px solid #888;
            border-radius: 3px;
            font-size: 12px;
            top: -5px;
            left: 15px;
            padding: 2px;
        }

        .info {
            font-size: 12px;
            padding: 5px;
        }

        .info .title {
            font-weight: bold;
        }
    </style>
</head>
<body>

<div id="map" style="width: 100%; height: 80vh;"></div>

<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=7560b5ddb94a9dc91354ef62a6b750ee"></script>
<script>
    var mapContainer = document.getElementById('map');
    var mapOption = {
        center: new kakao.maps.LatLng(35.1798200522868, 129.075087492149),
        level: 10
    };

    var map = new kakao.maps.Map(mapContainer, mapOption);
    var customOverlay = new kakao.maps.CustomOverlay({});

    const areas = [{
        name: '부산',
        path: []
    }];

    fetch('korea_b2.json')
    .then(response => {
        if (!response.ok) {
            throw new Error('Network response was not ok');
        }
        return response.json();
    })
    .then(jsonData => {
        const features = jsonData.features;
        
        // 서울의 데이터 가져오기
        const sido = features.find(feature => feature.properties.CTP_ENG_NM === "Seoul");
        const coordinates = sido.geometry.coordinates;

 
    
        // 서울의 좌표가 중첩된 배열일 경우
        coordinates.forEach(polygonCoordinates => {
            const path = polygonCoordinates.map(coord => new kakao.maps.LatLng(coord[1], coord[0]));
            areas[0].path.push(path);
        });
    
        // 지도에 다각형 표시 함수 호출
        displayArea(areas[0]);
    })
    .catch(error => {
        console.error('Error fetching JSON:', error);
    });


    // 다각형 표시 함수
    function displayArea(area) {
        var polygon = new kakao.maps.Polygon({
            map: map,
            path: area.path, // 다각형 path를 1차원 배열로 평평하게 만듭니다
            strokeWeight: 2,
            strokeColor: '#FF0000',
            strokeOpacity: 1,
            fillColor: '#00FF00',
            fillOpacity: 0.5
        });

        kakao.maps.event.addListener(polygon, 'mouseover', function (mouseEvent) {
            polygon.setOptions({fillColor: '#09f'});
            customOverlay.setContent('<div class="area">' + area.name + '</div>');
            customOverlay.setPosition(mouseEvent.latLng);
            customOverlay.setMap(map);
        });

        kakao.maps.event.addListener(polygon, 'mousemove', function (mouseEvent) {
            customOverlay.setPosition(mouseEvent.latLng);
        });

        kakao.maps.event.addListener(polygon, 'mouseout', function () {
            polygon.setOptions({fillColor: '#00FF00'}); // 원래의 fillColor로 변경
            customOverlay.setMap(null);
        });
    }
</script>

</body>
</html>
